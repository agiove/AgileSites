
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="author" content="Michele Sciabarra" />
    <title>ReadContent</title>

    <link rel="stylesheet" href="../assets/themes/dinky/css/styles.css">
    <link rel="stylesheet" href="../assets/themes/dinky/css/pygment_trac.css">
    <script src="../assets/themes/dinky/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-10041673-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header"><a href="../index.html">AgileSites</a></h1>
        <p class="header">the Easy framework for Agile development with Oracle WebCenter Sites</p>
        <ul>
            <li><a href="../download.html">Download</a></li>
            <li><a href="../about.html">About</a></li>
            <li><a href="../tutorial.html">Tutorial</a></li>
            <li><a href="../documentation.html">Documentation</a></li>
            <li><a href="https://github.com/sciabarra/AgileSites/issues">Issues</a></li>
            <li><a href="http://www.linkedin.com/groups/AgileSites-Fatwire-WebCenter-Sites-ATG-5120720">Group</a></li>
            <li><a href="https://twitter.com/AgileSitesFw">Twitter</a></li>
            <li><a href="http://www.sciabarra.com/fatwire/">Blog</a></li>
            <li><a href="http://github.com/sciabarra/AgileSites">GitHub</a></li>
            <li><a href="../contact.html">Contact</a></li>

        </ul>
        
      </header>

      <section>
      
<section>
  <h1>ReadContent</h1>

  <h5>Prev:  <a href="Picker.html">Picker</a>.</h5>

<p>In this section we will see how to create content specific for the home page.</p>

<p>In particular we will add a title, an image, a text and a reference to another page.</p>

<p>We will see then how to render those attributes.</p>

<h2>Creating a new attribute</h2>

<p>Here is described, step by step, how to create an attribute named <code>MyTitle</code>.</p>

<p>First go in the administrative interface, click on <strong>New</strong> and then click on <strong>New Page Attribute</strong></p>

<p><img src="../img/snap4806.png" alt="New Page Attribute"></p>

<p>Create a new Page Attribute named <code>MyTitle</code>, but use the name without the prefix in the description (so the user won&#39;t see the prefix). Select <code>string</code> as attribute type, and <code>single</code> as number of values.</p>

<p><img src="../img/snap4829.png" alt="New Page Attribute "></p>

<p>Now search for the Page Definition we created before. In the administrative interface, click on <code>Find</code> then <code>Find Page Definition</code>.</p>

<p><img src="../img/snap6558.png" alt="Find Page Definition"></p>

<p>Search for the <code>MyHome</code> page definition, edit it and add as a required field the newly created attribute <code>MyTitle</code>.</p>

<p><img src="../img/snap7313.png" alt="Add attribute"></p>

<h3>Add other attributes</h3>

<p>Now, create an attribute editor named <code>MyCKEditor</code> using this xml file:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;PRESENTATIONOBJECT&gt;</span>
 <span class="nt">&lt;CKEDITOR/&gt;</span>
<span class="nt">&lt;/PRESENTATIONOBJECT&gt;</span>
</code></pre></div>
<p>Following the same procedure as before, create the f../d\i/g\snap4286.pnglowing attributes:</p>

<ul>
<li><strong>MyText</strong>, attribute type <code>text</code>, single, attribute editor <code>MyCKEditor</code></li>
<li><strong>MyImage</strong>, attribute type <code>blob</code>, single</li>
<li><strong>MyRelated</strong>, attribute type <code>asset</code>, multipe, for asset type <code>Page</code>, asset subtypes <code>Any</code></li>
</ul>

<p>then add them to the Page Definition <code>MyHome</code> (<code>MyText</code> should be mandatory, <code>MyImage</code> and <code>MyRelated</code> optional).</p>

<p>Finally go in the contributor interface, and edit the content.  </p>

<p>You should see a form like this that you can fill with values to be used later.</p>

<p><img src="../img/snap4286.png" alt="Extra fields"></p>

<h2>The enviroment</h2>

<p>Each template has a corresponding class generated by the code generator. This class extends <code>wcs.java.Element</code> and must implement the method <code>apply</code> whose standard structure is</p>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">apply</span><span class="o">(</span><span class="n">Env</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Asset</span> <span class="n">a</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getAsset</span><span class="o">()</span>
    <span class="n">Picker</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Picker</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="s">&quot;...&quot;</span><span class="o">)</span>
    <span class="cm">/* replacements here */</span>
    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="na">html</span><span class="o">()</span> 
<span class="o">}</span>
</code></pre></div>
<p>Basically the <code>apply</code> method receive an <code>Env</code> that is a facade to access all the Sites enviroment.  A key method is <code>e.getAsset()</code> that will return an asset <code>Asset</code> instance. The <code>Asset</code> instance is the key since it allows to access to the attributes, either single and multiple. Note that all the multiple items are typically indexed using the <code>getRange</code> method that produces a iterator of integer.</p>

<p>There are other methods and features in the <code>Env</code>, most notably it allows to access to variables (<code>e.getString(&quot;List&quot;</code>) and lists (<code>e.getString(&quot;List&quot;, index, &quot;field&quot;</code>). </p>

<h2>Rendering the attribute</h2>

<p>For a quick introductory example a common usage is to pick a template, select the content then replace the title with the attribute title. Here <code>a.getString(&quot;Title&quot;)</code> returns the title attribute but it will be explained next. The typical Picker usage is then:</p>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="c1">// load the given template and then restrict to the element with id=body</span>
<span class="n">Picker</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Picker</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="s">&quot;/site/template.html&quot;</span><span class="o">,</span> <span class="s">&quot;#body&quot;</span><span class="o">);</span>
<span class="c1">// replace the html of the title with the actual title attribute</span>
<span class="n">p</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">&quot;#title&quot;</span><span class="o">,</span> <span class="n">a</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;Title&quot;</span><span class="o">);</span>
<span class="c1">// return the html</span>
<span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="na">html</span><span class="o">();</span>
</code></pre></div>
<p>Note that picker uses a fluent interface, and almost all the methods returns itself so the precedent example can be written:</p>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="k">return</span> <span class="n">Picker</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="s">&quot;/site/template.html&quot;</span><span class="o">,</span> <span class="s">&quot;#body&quot;</span><span class="o">)</span>
   <span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">&quot;#title&quot;</span><span class="o">,</span> <span class="n">a</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;Title&quot;</span><span class="o">).</span><span class="na">htlm</span><span class="o">();</span>
</code></pre></div>
<p>Multiple attributes are rendered using this code pattern:</p>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="nl">i:</span> <span class="n">a</span><span class="o">.</span><span class="na">getRange</span><span class="o">(</span><span class="s">&quot;Title&quot;</span><span class="o">))</span>  <span class="o">{</span>
  <span class="n">String</span> <span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;Title&quot;</span><span class="o">,</span> <span class="n">i</span><span class="o">));</span>
  <span class="c1">// use x</span>
<span class="o">}</span>
</code></pre></div>
<h2>Rendering an Image</h2>

<p>At attribute of type blob can be rendered using the <code>a.getBlobUrl(&quot;Blob&quot;)</code>. Here is an example to render the image using an html tag:</p>
<div class="highlight"><pre><code class="html language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">id=</span><span class="s">&quot;image-main&quot;</span><span class="nt">&gt;</span>
</code></pre></div>
<p>with this code:</p>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="n">String</span> <span class="n">image</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">getBlobUrl</span><span class="o">(</span><span class="s">&quot;Image&quot;</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">image</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
    <span class="n">html</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="s">&quot;#image-main&quot;</span><span class="o">);</span>
<span class="k">else</span>
    <span class="n">html</span><span class="o">.</span><span class="na">attr</span><span class="o">(</span><span class="s">&quot;#image-main&quot;</span><span class="o">,</span> <span class="s">&quot;src&quot;</span><span class="o">,</span> <span class="n">image</span><span class="o">);</span>
</code></pre></div>
<h2>Invoking a template</h2>

<p>When you have an attribute of type asset, you can render the linked template loading the template with <code>a.getAsset(&quot;Related&quot;,&quot;Page&quot;)</code> then invoking the template with <code>a.call(&quot;DmSummary&quot;)</code>. Note that:</p>

<ul>
<li>the <code>a.getAsset</code> requires you specify the type of the linked asset, since it is not stored in the attribute (only the id is)</li>
<li>you need to call the template by name using the loaded asset</li>
</ul>

<p>The standard code to render a linked asset is (assuming the asset is of type <code>Page</code> using the <code>DmSummary</code> template) is then:</p>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="n">a</span><span class="o">.</span><span class="na">getAsset</span><span class="o">(</span><span class="s">&quot;Related&quot;</span><span class="o">,</span> <span class="s">&quot;Page&quot;</span><span class="o">).</span><span class="na">call</span><span class="o">(</span><span class="s">&quot;DmSummary&quot;</span><span class="o">)</span>
</code></pre></div>
<h5>Next:  <a href="Testing.html">Testing</a></h5>


  
</section>


         <p style="font-size: 80%; text-align: center;">
            <b>AgileSites</b> - Written by <a href="http://linkedin.com/in/msciab">Michele Sciabarr&agrave;</a> - &copy; 2013 <a href="http://www.sciabarra.com">Sciabarra srl</a><br>Open Source Software releases under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License 2.0</a>
            <br>Credits: Hosted on <a href="http://pages.github.com/">GitHub Pages</a> using the <a href="https://github.com/sodabrew/theme-dinky">Dinky theme</a> for <a href="http://jekyllbootstrap.com/">Jekyll Bootstrap</a></small>
          </p>
      </section>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>

